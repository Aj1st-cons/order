<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tab-Separated Generator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px;
    }
    textarea, input[type="text"] {
      width: 100%;
      padding: 8px;
      margin-bottom: 10px;
      font-size: 14px;
    }
    button {
      padding: 10px 20px;
      font-size: 14px;
      cursor: pointer;
      background: #009500;
    }
    #result {
      margin-top: 20px;
      padding: 10px;
      background: #f4f4f4;
      word-wrap: break-word;
    }
  </style>
</head>
<body>
  <h2>Email Content to Tab-Separated Output</h2>
  <textarea id="emailContent" rows="10" placeholder="Paste the email content here..."></textarea>
  <button id="generateBtn">Generate</button>
  
  <h3>Output</h3>
  <div id="result"></div>
  <button id="copyBtn">Copy Output</button>

  <script>
    // Helper function to extract value from a line
    function extractValue(line) {
      const parts = line.split(":");
      return parts.slice(1).join(":").trim();
    }

    document.getElementById("generateBtn").addEventListener("click", function() {
      const content = document.getElementById("emailContent").value;
      // Split content by new lines and filter out empty lines
      const lines = content.split(/\r?\n/).filter(line => line.trim() !== "");
      
      // Create an object to hold the extracted values
      const data = {
        "REFF-Code": "",
        "Affiliate Email": "",
        "Store Name": "",
        "Store Location": "",
        "Store's Address": "",
        "Seller Email": "",
        "Contact Number": ""
      };

      // Loop over each line and fill in the data object if a key matches
      lines.forEach(line => {
        // Trim any extra spaces
        line = line.trim();
        // For each key in our data object, check if the line starts with it
        Object.keys(data).forEach(key => {
          if(line.startsWith(key + ":")) {
            data[key] = extractValue(line);
          }
        });
      });

      // Create the output string in the desired order:
      // value of Ref-Code, value of Email, value of Name, contact, Social media, platform id
      const output = [
        data["REFF-Code"],
        data["Affiliate Email"],
        data["Store Name"],
        data["Store's Address"],
        data["Store Location"],
        data["Seller Email"],
        data["Contact Number"]
      ].join("\t");

      document.getElementById("result").textContent = output;
    });

    document.getElementById("copyBtn").addEventListener("click", function() {
      const outputText = document.getElementById("result").textContent;
      // Create a temporary textarea to copy the text
      const tempTextarea = document.createElement("textarea");
      tempTextarea.value = outputText;
      document.body.appendChild(tempTextarea);
      tempTextarea.select();
      document.execCommand("copy");
      document.body.removeChild(tempTextarea);
      alert("Output copied to clipboard!");
    });
  </script>
</body>
</html>
