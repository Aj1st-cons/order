<body>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vendor Registration</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 2rem; }
form { max-width: 400px; margin: auto; }    
input { width: 100%; padding: 0.5rem; margin-top: 1rem; }
input:focus {
  outline: 2px solid #009500; 
}
button { 
  background: #009500;
  color: white;
  border: none;
  cursor: pointer;
  font-weight: bold;
  padding: 10px 20px;
  border-radius: 20px; 
  white-space: nowrap;
  width: auto;
  display: block;
  margin: 10px auto;
  font-size: 16px;
}
.message { margin-top: 1rem; font-weight: bold; }   
.overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.8);
  color: #fff; 
  padding-top: 300px; 
  justify-content: center;
  align-items: center;
  text-align: center;
  z-index: 10000;
  font-size: 16px;
  display: none;
}
.countdown {
  text-align: center;
  margin-top: 1rem;
  font-size: 18px;
  color: #333;
}
#responseMessage {
    text-align: center;
}
  </style>
</head>
<body>
  <h1 style="text-align: center;">Vendor Registration</h1>
  <form id="contactForm">
          
  <input type="text" id="firstName" placeholder="First Name" name="firstName" required /> 

  <input type="text" id="lastName" placeholder="Last Name" name="lastName" required />

<input type="text" id="storeName" placeholder="Store Name" name="storeName" required />

<input type="text" id="storeCategory" placeholder="Store Category (e.g., Grocery, Electronics, Laundry, etc.)" name="storeCategory" required />

<!--  -->
  <div style="display: flex;">
    <input type="text" id="storeLocation" placeholder="Click 'Get' to get location" name="storeLocation" disabled />
    <button style="margin-bottom:-5px; padding:0 15px;" type="button" id="getLocationButton">Get</button>
  </div>

  <div id="timer" class="countdown"></div>
<!--  -->

<input type="text" id="storesAddress" placeholder="Store's Address" name="storesAddress" required />

<input type="email" id="email" placeholder="Email Address" name="email" required />

<input type="text" id="contactNumber" placeholder="Contact Number" name="contactNumber" required />

<input type="text" id="reffCode" placeholder="REFF-Code" name="reffCode" required />

<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
    <button type="submit">Submit</button>
  </form>
<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
  <div class="message" id="responseMessage"></div>
<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<div class="overlay" id="overlayMessage">
 <b>Thank you,</b>
 <br><br>
 your informations have been sent successfully. <br><br>
 We will be in touch with you soon!
</div>
<div class="countdown" id="countdownTimer"></div>
<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
  <script>
      // Extra JS modifications
document.getElementById('contactForm').addEventListener('submit', async function(e) {
  e.preventDefault();

  const submitButton = this.querySelector('button[type="submit"]');
  submitButton.textContent = 'Submitting';
  submitButton.disabled = true;

  let countdown = 30;
  const countdownTimer = document.getElementById('countdownTimer');
  countdownTimer.textContent = countdown +       " seconds";
  
  const intervalId = setInterval(() => {
    countdown--;
    countdownTimer.textContent = countdown;
    if(countdown <= 0) {
      clearInterval(intervalId);
    }
  }, 1000);

  const formData = {
    firstName: document.getElementById('firstName').value,
    lastName: document.getElementById('lastName').value,
    storeName: document.getElementById('storeName').value,
    storeCategory: document.getElementById('storeCategory').value,
    storeLocation: document.getElementById('storeLocation').value,
    storesAddress: document.getElementById('storesAddress').value,
    email: document.getElementById('email').value,
    contactNumber: document.getElementById('contactNumber').value,
    reffCode: document.getElementById('reffCode').value
  };

  try {
    const response = await fetch('https://bronzed-carpal-zone.glitch.me/send-email', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(formData)
    });
    
    clearInterval(intervalId);
    
    if(response.ok){
      document.getElementById('responseMessage').textContent = 'Submitted. Thank you!';
      document.getElementById('contactForm').reset();
      submitButton.textContent = 'Submit';
      submitButton.disabled = false;
      // Show full-screen overlay
      document.getElementById('overlayMessage').style.display = 'block';
      // Optionally, hide overlay after a few seconds
      setTimeout(() => {
        document.getElementById('overlayMessage').style.display = 'none';
      }, 5000);
      countdownTimer.textContent = '';
    } else {
      document.getElementById('responseMessage').textContent = 'Submission failed. Please try again.';
      submitButton.textContent = 'Submit';
      submitButton.disabled = false;
    }
  } catch (error) {
    clearInterval(intervalId);
    document.getElementById('responseMessage').textContent = 'An error occurred. Please try again.';
    submitButton.textContent = 'Submit';
    submitButton.disabled = false;
  }
});
  </script>
  <script>      document.getElementById('getLocationButton').addEventListener('click', function() {
  // Disable button while waiting for location
  const button = document.getElementById('getLocationButton');
  button.disabled = true;
  let countdown = 30;
  const timerElement = document.getElementById('timer');
  timerElement.textContent = `Please wait... ${countdown}s`;

  // Request location
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(function(position) {
      const lat = position.coords.latitude;
      const lng = position.coords.longitude;
      
      // Get store name and category
      const storeName = document.getElementById('storeName').value;
      const storeCategory = document.getElementById('storeCategory').value;

      // Update location input
      document.getElementById('storeLocation').value = `${storeName}: { lat: ${lat}, lng: ${lng}, categories: ["${storeCategory}"] }`;

      // Start countdown timer after getting location
      const countdownInterval = setInterval(function() {
        countdown--;
        timerElement.textContent = `Location received. ${countdown}s remaining...`;
        
        if (countdown <= 0) {
          clearInterval(countdownInterval);
          timerElement.textContent = 'Thank you! Your location has been saved.';
        }
      }, 1000);
    }, function(error) {
      console.error(error);
      timerElement.textContent = 'location unavailable. turn it ON';
timerElement.style.color = '#B83C08';
timerElement.style.fontSize = '16px';
      button.disabled = false; // Enable button again if there's an error
    });
  } else {
    timerElement.textContent = 'Geolocation is not supported by this browser.';
    button.disabled = false; // Enable button if geolocation is not supported
  }
});
  </script>
</body>
</html>
